# advanced-vision-assignment

アドバンスドビジョンの課題レポジトリです

## 1. CNNの基本的考え方

畳み込みニューラルネットワーク（CNN: Convolutional Neural Network）は，画像の局所領域に注目して特徴を抽出し，
層を重ねることで画像全体の特徴を捉えるニューラルネットワークである。

CNNは主に以下の層から構成される。

- 畳み込み層（Convolutional Layer）
- プーリング層（Pooling Layer）
- ソフトマックス層（Softmax Layer / 分類層）

---

## 2. 畳み込み層（Convolutional Layer）

### 2.1 局所領域への写像

入力画像の一部である  
$n \times n$ 画素の正方領域（窓）を考える。

この領域内の画素値を  
$x(i, j)$  

対応するフィルタ（重み）を  
$w(i, j)$  

とすると，畳み込み層の出力 $y$ は次式で与えられる。

$$
y = \sum_{i=1}^{n} \sum_{j=1}^{n} w(i, j)\,x(i, j) + b
$$

ここで，

- $x(i, j)$：入力画像の画素値  
- $w(i, j)$：フィルタの重み（学習対象）  
- $b$：バイアス（学習対象）  

である。

この演算はアダマール積（要素ごとの積）を取り，総和する操作に相当する。

---

### 2.2 フィルタのスライド（ストライド）

フィルタを画像上でずらしながら適用する。

- ストライド = 1 ：1画素ずつ移動  
- ストライド > 1 ：間引きながら移動  

画像サイズを保ちたい場合にはパディングを行う。

---

### 2.3 フィルタの意味

フィルタは，

- エッジ
- 方向性
- 局所的な濃度変化

などの局所特徴を検出する役割を持つ。

CNNでは，フィルタの重み $w(i, j)$ 自体を
誤差逆伝播法によって学習する点が特徴である。

---

## 3. チャネル（Channel）

カラー画像（RGB）の場合，入力は

$$
X \in \mathbb{R}^{H \times W \times 3}
$$

となり，各画素は3次元ベクトルとして扱われる。

- 1つのフィルタは全チャネルに対して重みを持つ  
- 各チャネルでの畳み込み結果を足し合わせて1つの出力を生成  

また，複数のフィルタを用いることで出力チャネル数を増やすことができる。

---

## 4. プーリング層（Pooling Layer）

### 4.1 目的

プーリング層の目的は以下の通りである。

- 特徴の強い画素を残す  
- 画素数を減らす  
- 位置ズレに対する頑健性を高める  

---

### 4.2 Max Pooling の数式

プーリング領域 $\Omega$ に対し，Max Pooling は次式で定義される。

$$
y = \max_{(i,j) \in \Omega} x(i, j)
$$

プーリング層では学習は行われない。

---

## 5. ソフトマックス層（Softmax Layer）

### 5.1 出力の意味

ソフトマックス層は，最終的な分類結果を
確率として出力するための層である。

---

### 5.2 数式

入力ベクトル

$$
x = (x_1, x_2, \dots, x_n)
$$

に対し，ソフトマックス関数は

$$
y_i = \eta e^{x_i}
$$

ただし，正規化定数 $\eta$ は

$$
\eta = \frac{1}{\sum_{j=1}^{n} e^{x_j}}
$$

とすることで，

$$
\sum_{i=1}^{n} y_i = 1
$$

が成り立つ。

---

## 6. CNN全体の処理の流れ

